{"version":3,"file":"vue.js","sources":["../src/observe/arr.js","../src/observe/index.js","../src/initState.js","../src/init.js","../src/index.js"],"sourcesContent":["// 获取原来的数组方法\r\nlet oldArrayProtoMethods = Array.prototype\r\n// 继承 创建新的方法对象\r\nexport let arrMethods = Object.create(oldArrayProtoMethods)\r\n\r\nlet methods = ['push','pop',\"unshift\",\"shift\",\"splice\"]\r\n\r\nmethods.forEach(item=>{\r\n    arrMethods[item] = function(...args){\r\n        console.log('劫持数组');\r\n       let result =  oldArrayProtoMethods[item].apply(this,args)\r\n       return result\r\n    }\r\n})","import { arrMethods } from \"./arr\"\r\n\r\nexport function observer(data){\r\n    if(typeof data != 'object' || data == null){\r\n        return data\r\n    }\r\n\r\n    return new Observer(data)\r\n\r\n}\r\n\r\nclass Observer{\r\n    constructor(data){\r\n        if(Array.isArray(data)){\r\n            data.__proto__ = arrMethods\r\n            // 如果是对象数组，对数组对象劫持\r\n            this.observeArray(data)\r\n        }else{\r\n            this.walk(data) \r\n        }\r\n    }\r\n    // 遍历对象的属性，响应式劫持\r\n    walk(data){\r\n        let keys = Object.keys(data)\r\n        for(let i =0;i<keys.length;i++){\r\n            let key = keys[i]\r\n            let value = data[key]\r\n            defineReactive(data,key,value)\r\n        }\r\n    }\r\n    // 遍历对象数组\r\n    observeArray(value){\r\n        value.forEach(i=>{\r\n\r\n        })\r\n    }\r\n\r\n}\r\nfunction defineReactive(data,key,value){\r\n    observer(value)\r\n    Object.defineProperty(data,key,{\r\n        get(){\r\n            console.log('获取pbj');\r\n            return value\r\n        },\r\n        set(newValue){\r\n            console.log('设置obj');\r\n            if(newValue==value){\r\n                return\r\n            }\r\n            observer(newValue)\r\n            value = newValue\r\n        }\r\n    })\r\n}\r\n","import { observer } from \"./observe/index\"\r\n\r\n\r\nexport function initState(vm){\r\n    let ops = vm.$options\r\n    if(ops.props){\r\n        initProps(vm)\r\n    }   \r\n    if(ops.data){\r\n        initData(vm)\r\n    }\r\n    if(ops.watch){\r\n        initWatch(vm)\r\n    }\r\n    if(ops.methods){\r\n        initMethods(vm)\r\n    }\r\n    if(ops.computed){\r\n        initComputed(vm)\r\n    }\r\n}\r\n// 初始化data\r\nfunction initData(vm){\r\n    let data = vm.$options.data\r\n    // data()  this默认window \r\n    data = vm._data = typeof data == 'function'?data.call(vm):data \r\n\r\n    observer(data)\r\n}\r\n\r\nfunction initProps(){}\r\nfunction initWatch(){}\r\nfunction initMethods(){}\r\nfunction initComputed(){}","import { initState } from \"./initState\";\r\nexport function initMixin(Vue){\r\n\r\n    Vue.prototype._init = function(options){\r\n        let vm = this\r\n        vm.$options = options\r\n        // init 状态\r\n        initState(vm)\r\n    }\r\n}","import { initMixin } from \"./init\";\r\n\r\nfunction Vue(options){\r\n     this._init(options)\r\n    \r\n\r\n\r\n}\r\n\r\ninitMixin(Vue)\r\n\r\nexport default Vue"],"names":["oldArrayProtoMethods","Array","prototype","arrMethods","Object","create","methods","forEach","item","console","log","args","result","apply","observer","data","Observer","isArray","__proto__","observeArray","walk","keys","i","length","key","value","defineReactive","defineProperty","get","set","newValue","initState","vm","ops","$options","props","initData","watch","computed","_data","call","initMixin","Vue","_init","options"],"mappings":"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"}