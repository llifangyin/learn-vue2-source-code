{"version":3,"file":"vue.js","sources":["../src/observe/arr.js","../src/observe/index.js","../src/initState.js","../src/compile/parseAst.js","../src/compile/generate.js","../src/compile/index.js","../src/init.js","../src/index.js"],"sourcesContent":["// 获取原来的数组方法\r\nlet oldArrayProtoMethods = Array.prototype\r\n// 继承 创建新的方法对象\r\nexport let arrMethods = Object.create(oldArrayProtoMethods)\r\n\r\nlet methods = ['push','pop',\"unshift\",\"shift\",\"splice\"]\r\n\r\nmethods.forEach(item=>{\r\n    arrMethods[item] = function(...args){\r\n        console.log('劫持数组');\r\n       let result =  oldArrayProtoMethods[item].apply(this,args)//this当前实例对象，\r\n        //observe中把类整体赋值给了__ob__可供在此调用数据劫持方法obseveArray\r\n\r\n        //args :push时为添加的数组参数\r\n        // 追加的数组对象进行数据劫持 push unshift  splice(第三个参数时新增的)\r\n        let inserted;\r\n        switch(item){\r\n            case 'push':\r\n            case 'unshift':\r\n                inserted = args\r\n                break;\r\n            case 'splice':\r\n                inserted = args.splice(2)//arr.splice(0,1,{a:6})\r\n                break\r\n        }\r\n\r\n        // console.log(this,'this');//当前调用的数组对象\r\n        let ob = this.__ob__\r\n        if(inserted){\r\n            //对添加的对象进行劫持\r\n            ob.observeArray(inserted)\r\n        }\r\n        console.log(inserted,111);\r\n    \r\n       return result\r\n    }\r\n})","import { arrMethods } from \"./arr\"\r\n\r\nexport function observer(data){\r\n\r\n    if(typeof data != 'object' || data == null){\r\n        return data\r\n    }\r\n\r\n    return new Observer(data)\r\n\r\n}\r\n\r\nclass Observer{\r\n    constructor(data){\r\n        // 定义一个属性\r\n        Object.defineProperty(data,'__ob__',{\r\n            enumerable:false,\r\n            value:this,//this当前实例 this.observeArray\r\n        })\r\n\r\n        if(Array.isArray(data)){\r\n            // 对数组的方法进行劫持行操作\r\n            data.__proto__ = arrMethods\r\n            // 如果是对象数组，对数组对象劫持\r\n            this.observeArray(data)\r\n        }else{\r\n            this.walk(data) \r\n        }\r\n    }\r\n    // 遍历对象的属性，响应式劫持\r\n    walk(data){\r\n        let keys = Object.keys(data)\r\n        for(let i =0;i<keys.length;i++){\r\n            let key = keys[i]\r\n            let value = data[key]\r\n            defineReactive(data,key,value)\r\n        }\r\n    }\r\n    // 遍历对象数组\r\n    observeArray(value){\r\n        value.forEach(data=>{\r\n            observer(data)\r\n        })\r\n    }\r\n\r\n}\r\nfunction defineReactive(data,key,value){\r\n    observer(value)\r\n    Object.defineProperty(data,key,{\r\n        get(){\r\n            // console.log('获取pbj');\r\n            return value\r\n        },\r\n        set(newValue){\r\n            // console.log('设置obj');\r\n            if(newValue==value){\r\n                return\r\n            }\r\n            observer(newValue)\r\n            value = newValue\r\n        }\r\n    })\r\n}\r\n","import { observer } from \"./observe/index\"\r\n\r\n\r\nexport function initState(vm){\r\n    let ops = vm.$options\r\n    if(ops.props){\r\n        initProps(vm)\r\n    }   \r\n    if(ops.data){\r\n        initData(vm)\r\n    }\r\n    if(ops.watch){\r\n        initWatch(vm)\r\n    }\r\n    if(ops.methods){\r\n        initMethods(vm)\r\n    }\r\n    if(ops.computed){\r\n        initComputed(vm)\r\n    }\r\n}\r\n// 初始化data\r\nfunction initData(vm){\r\n    let data = vm.$options.data\r\n    // data()  this默认window \r\n    data = vm._data = typeof data == 'function'?data.call(vm):data \r\n\r\n    //将对象上的所有属性，代理到实例上{a:1,b:@}  defineProperty\r\n    for(let key  in data){\r\n        Proxy(vm,'_data',key)    \r\n    }\r\n\r\n    observer(data)\r\n}\r\nfunction Proxy(vm,source,key){\r\n    Object.defineProperty(vm,key,{\r\n        get(){\r\n            return vm[source][key]\r\n        },\r\n        set(val){\r\n            vm[source][key] = val\r\n        }\r\n    })\r\n}\r\nfunction initProps(){}\r\nfunction initWatch(){}\r\nfunction initMethods(){}\r\nfunction initComputed(){}","\r\n\r\n// ast语法树 {} 操作节点 css js\r\n//  vnode {}操作节点\r\n// <div id=\"app\">hello {{msg}} </div>\r\n/* \r\n{\r\n    tag:\"div\",\r\n    attrs:[{id:\"app\"}],\r\n    children:[{\r\n        tag:null,\r\n        text:'hello{{msg}}'\r\n    }]\r\n}\r\n*/\r\n// 声明正则 匹配标签开头结尾 属性 \r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*` //标签名 a h span \r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})` //<span:xx> 特殊标签\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`)//标签开头的正则，捕获的内容是标签名\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`)//匹配标签结尾的</div>\r\n// attr='xxx'\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/ \r\nconst startTagClose = /^\\s*(\\/?)>/  //匹配标签结束时的>\r\n\r\n// 创建ast对象\r\nfunction createAstElement(tag,attrs){\r\n    return {\r\n        tag,//元素\r\n        attrs,//属性\r\n        children:[],//子集\r\n        type:1,//dom 1\r\n        parent:null\r\n    }\r\n}\r\n\r\nlet root;//根元素\r\nlet createdParent;//当前元素父节点\r\nlet stack=[]; //栈的数据解构 [div,h]\r\n\r\n\r\n// 开始的标签 添加至root 语法树解构的对象中\r\nfunction start(tag,attrs){\r\n    // console.log(tag,attrs,'开始标签');\r\n    let element = createAstElement(tag,attrs)\r\n    if(!root){\r\n        root = element\r\n    }\r\n    createdParent = element\r\n    stack.push(element)\r\n}\r\n// 文本\r\nfunction charts(text){\r\n    // console.log(text,'文本');\r\n    text = text.replace(/a/g,'')//去空格\r\n    if(text){\r\n        createdParent.children.push({\r\n            type:3,\r\n            text\r\n        })\r\n    }\r\n}\r\nfunction end(tag){\r\n    // console.log(tag,'结束标签');\r\n    let element = stack.pop()\r\n    createdParent = stack[stack.length-1]\r\n    if(createdParent){ //元素的闭合\r\n        element.parent = createdParent.tag\r\n        createdParent.children.push(element)\r\n    }\r\n}\r\n\r\n\r\n\r\n// 解析html\r\n// 遍历\r\nexport function parseHTML(html){\r\n    // 开始标签 文本 结束标签\r\n    // 一层层的剥离html的内容\r\n    while(html){\r\n        let textEnd = html.indexOf('<')//有0 无-1\r\n        if(textEnd ===0){\r\n            // 1开始标签    \r\n            const startTagMatch = parseStartTag() //开始标签的内容\r\n            if(startTagMatch){\r\n                start(startTagMatch.tagName,startTagMatch.attrs)\r\n                continue\r\n            }\r\n            \r\n            // 2结束标签\r\n            let endTagMatch = html.match(endTag)\r\n            // console.log(endTagMatch,'endTagMatch');\r\n            if(endTagMatch){\r\n                advance(endTagMatch[0].length)\r\n                end(endTagMatch[1])\r\n                continue\r\n            }\r\n        }\r\n        let text \r\n        // 文本\r\n        if(textEnd>0){\r\n            // 获取文本内容\r\n            // console.log(html);\r\n            text = html.substring(0,textEnd)\r\n            // console.log(text);\r\n        }\r\n        if(text){\r\n            advance(text.length)\r\n            charts(text)\r\n            // console.log(html);\r\n        }\r\n        // break;\r\n    }\r\n    function parseStartTag(){\r\n        // 匹配开始标签\r\n        const start = html.match(startTagOpen)//1结果 2false\r\n        // console.log(start);\r\n        if(!start) return false\r\n        // 创建ast语法树\r\n        let match = {\r\n            tagName:start[1],\r\n            attrs:[],\r\n        }\r\n        // 删除开始标签\r\n        advance(start[0].length)\r\n        // 遍历属性,结束标签>\r\n        let attr,end \r\n        while(!(end = html.match(startTagClose) ) && (attr = html.match(attribute)) ){\r\n            // console.log(end);\r\n            // console.log(attr);\r\n            match.attrs.push({\r\n                name:attr[1],\r\n                value:attr[3]||attr[4]||attr[5]\r\n            })\r\n            advance(attr[0].length)\r\n        }\r\n        // console.log(end);\r\n        if(end){\r\n            advance(end[0].length)\r\n            return match\r\n        }\r\n    }\r\n    function advance(n){\r\n       html =  html.substring(n)\r\n        // console.log(html);\r\n    }\r\n    return root\r\n}\r\n  ","//   <div id='app'>hello{{msg}}<h></h></div>\r\n// render(){ //_c解析标签\r\n//     return _c('div',{id:app},_v('hello'+_s(msg)),_c('h',''))\r\n// }\r\n// 插值表达式\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\r\n\r\n\r\nfunction genProps(attrs){\r\n    let str =''\r\n    for(let i = 0;i<attrs.length;i++){\r\n        let attr = attrs[i]\r\n        // 处理style属性\r\n        let obj = {}\r\n        if(attr.name=='style'){\r\n            attr.value.split(';').forEach(item=>{\r\n                let [key,val]=item.split(':')\r\n                obj[key] = val\r\n            })\r\n            attr.value = obj\r\n        }\r\n        str += `${attr.name}:${JSON.stringify(attr.value)},`\r\n    }\r\n     return `{${str.slice(0,-1)}}`\r\n}\r\n// 处理子节点\r\nfunction genChildren(el){\r\n    let children = el.children\r\n    // console.log(children);\r\n    if(children){\r\n        return children.map(child=>gen(child)).join(',')\r\n    }\r\n}\r\nfunction gen(node){\r\n    // 元素 _c\r\n    if(node.type === 1){\r\n        return generate(node)\r\n    }else{\r\n        //文本\r\n        // 1.纯文本 _v\r\n        // 2.插值表达式 _s\r\n        let text = node.text //获取文本\r\n        if(!defaultTagRE.test(text)){\r\n            // console.log(text);\r\n            // 普通文本\r\n            return `_v(${JSON.stringify(text)})`\r\n        }\r\n        // 特殊文本 带有插值表达式 {{}} \r\n        let tokens = []\r\n        let lastindex = defaultTagRE.lastIndex = 0 //正则调用多次的情况lastIndex匹配过后置位0可以再次使用 {{a}} {{b}}\r\n        let match \r\n        while (match = defaultTagRE.exec(text)) {\r\n            // console.log(match);\r\n            // hello {{msg}} dd\r\n            let index = match.index\r\n            if(index > lastindex){\r\n                // 添加内容\r\n                tokens.push(JSON.stringify(text.slice(lastindex,index)))\r\n            }\r\n            tokens.push(`_s(${match[1].trim()})`)\r\n            lastindex = index + match[0].length\r\n\r\n        }\r\n        if(lastindex<text.length){\r\n            tokens.push(JSON.stringify(text.slice(lastindex)))\r\n        }\r\n        // console.log({tokens});\r\n        return `_v(${tokens.join('+')})`\r\n    }\r\n}\r\nexport function generate(el){\r\n    // 处理子节点\r\n    let children = genChildren(el)\r\n    // console.log(children);\r\n    // 字符串模板\r\n    let code = `_c('${el.tag}',${el.attrs.length?`${genProps(el.attrs)}`:'undefined'}${children?`,${children}`:''})`\r\n    // console.log(code);\r\n    // _c('div',{id:\"app\",style:{\"color\":\"cyan\",\"margin\":\"10px\"}},_v(\"\\n        hello \"+_s(msg)+\" \\n        \"),_c('h2',undefined,_v(\"张三\")),_v(\"\\n    \"))\r\n    return code\r\n\r\n}","import {parseHTML} from './parseAst';\r\nimport {generate} from './generate';\r\nexport function compileToFunction(el){\r\n    // 1.将html变成ast语法树\r\n    let ast = parseHTML(el)\r\n\r\n    // 2.将ast语法树 变成render函数\r\n        // (1) ast语法树变成字符串拼接 (2) 字符串变成render函数\r\n    \r\n    let code = generate(ast)\r\n    console.log(code);\r\n}","import { initState } from \"./initState\";\r\nimport {compileToFunction} from './compile/index'\r\nexport function initMixin(Vue){\r\n\r\n    Vue.prototype._init = function(options){\r\n        let vm = this\r\n        vm.$options = options\r\n        // init 状态\r\n        initState(vm)\r\n\r\n        //渲染模板 el\r\n        if(vm.$options.el){\r\n            vm.$mounted(vm.$options.el)\r\n        }\r\n    }\r\n\r\n    // 创建$moutned\r\n    Vue.prototype.$mounted = function(el){\r\n        // console.log(el);\r\n        // el template render\r\n        let vm = this\r\n        let options = vm.$options\r\n        el = document.querySelector(el)\r\n        // 没有render函数\r\n        if(!options.render){\r\n            let template = options.template\r\n            // 没有template option \r\n            // 则 Compile el's outerHTML as template *\r\n            if(!template && el){\r\n                // 获取Html\r\n                el = el.outerHTML //html字符串\r\n                // <div id=\"app\">hello {{msg}} </div>\r\n                // 变成ast语法树\r\n                let ast = compileToFunction(el)\r\n\r\n                // render\r\n\r\n                // vnode\r\n                // console.log(el);\r\n            }\r\n        }\r\n    }\r\n}\r\n","import { initMixin } from \"./init\";\r\n\r\nfunction Vue(options){\r\n     this._init(options)\r\n    \r\n\r\n\r\n}\r\n\r\ninitMixin(Vue)\r\n\r\nexport default Vue"],"names":["oldArrayProtoMethods","Array","prototype","arrMethods","Object","create","methods","forEach","item","console","log","args","result","apply","inserted","splice","ob","__ob__","observeArray","observer","data","Observer","defineProperty","enumerable","value","isArray","__proto__","walk","keys","i","length","key","defineReactive","get","set","newValue","initState","vm","ops","$options","props","initData","watch","computed","_data","call","Proxy","source","val","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","createAstElement","tag","attrs","children","type","parent","root","createdParent","stack","start","element","push","charts","text","replace","end","pop","parseHTML","html","textEnd","indexOf","startTagMatch","parseStartTag","tagName","endTagMatch","match","advance","substring","attr","name","n","defaultTagRE","genProps","str","obj","split","JSON","stringify","slice","genChildren","el","map","child","gen","join","node","generate","test","tokens","lastindex","lastIndex","exec","index","trim","code","compileToFunction","ast","initMixin","Vue","_init","options","$mounted","document","querySelector","render","template","outerHTML"],"mappings":"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"}